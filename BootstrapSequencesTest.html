<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Comparing Seuqences with Bootstrap and D3</title>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

    <!-- Bootstrap -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- Include all compiled plugins (below), or include individual files as needed -->

    <!-- Minified D3 -->
    <script src="https://d3js.org/d3.v4.min.js"></script>
  </head>
  <style>
      div {
        display: block;
      }
      text {
        font-family: "Lucida Console", Monaco, monospace;
      }
      div[class*=container-fluid] {
        padding-top: 10px;
      }
      div[class*=col-xs-1] {
        padding: 0px;
      }
      div[class*=col-xs-11] {
        padding: 0px;
        border-style: none;
      }
      div[class*=namePlate] {
        background-color: rgba(220,220,220,.85);
        padding: 0px;
        border: solid;
        border-width: 1px;
        border-color: rgb(180,180,180);
        border-radius: 5px;
        text-align: center;
        vertical-align: middle;
      }
      p {
        margin: 0;
        padding: 0;
        line-height: 14px;
      }
      .buttons {
        padding-left: 10px;
        padding-top: 10px;
      }
      .sequence {
        word-wrap:    break-word;
        background-color: rgba(220,220,220,.75);
      }
      .adenine {
        word-wrap:    break-word;
        background-color: dodgerblue;
      }
      .cytosine {
        word-wrap:    break-word;
        background-color: orange;
      }
      .guanine {
        word-wrap:    break-word;
        background-color: lightgreen;
      }
      .thymine {
        word-wrap:    break-word;
        background-color: orchid;
      }
  </style>
  <body>
    <p class="buttons">
      <button type="button" class="btn btn-default btn-sm" onclick="defaultize()">Default</button>
      <button type="button" class="btn btn-primary btn-sm" onclick="colorize()">Color Code</button>
    </p>
    <script>

        //Sample Data
        var data = [
          {"name": "Human", "value": "CGGTGGCCGTTATGTTCGTCATTCCGCCTAAACCCGCGGGGACATCGGACCTCGTACATTCTTCGAGCTATAGTCTTAGTTGGACATATGATCCGCTCCA"},
          {"name": "Dog", "value": "TGCCACACGACAGTTACCAAGGATGATACTGGACGGGCCATCTTGGCTTTTTAGTGCTGACTGAGCAGGCGGATATTGGTCAACTTTGAGAATGTGTGTA"},
          {"name": "Rat", "value": "AGCAGAATACCCAAGCGTGTCGAGCGGCTCCACCTCACCATGATAGCACGGCGTTTGAACCTCGGTCTGGGTAAGATGGAGGCGATGTATTGTGGAATTG"}
        ];

        //Creates div container to hold everything
        var container = d3.select("body")
                          .append("div")
                          .attr("class", "container-fluid");

                        //Creates a row for each datum and creates the names column
        var row       = container.selectAll("div")
                          .data(data)
                          .enter()
                          .append("div")
                          .attr("class", "row")
                          
                        //Appends names
                        row.append("div")
                          .attr("class", "col-xs-1")
                          .append("div")
                          .attr("class", "namePlate")
                          .append("p")
                          .selectAll("p")
                          .data(function(d) { return d.name; })
                          .enter()
                          .append("text")
                          .text(function(d, i) { return d; });

                        //Appends sequences
        var sequences = row.append("div")
                          .attr("class", "col-xs-11")
                          .append("p")
                          .selectAll("text")
                          .data(function(d) { return d.value; })
                          .enter()
                          .append("text")
                          .text(function(d) { return d; })
                          .attr("class", "sequence");

                        //Creates row for axis
        var axisRow   = container.append("div")
                          .attr("class", "row");

                        axisRow.append("div")
                          .attr("class", "col-xs-1");
                        
        var svgCol    = axisRow.append("div")
                          .attr("class", "col-xs-11")
                          .attr("id", "area");

        var width     = parseInt(d3.select("#area").style("width"), 10);
                        //Appends svg to bottom row
        var svg       = svgCol.append("svg")
                          .attr("width", width)
                          .attr("height", 50);
                        //Horizontal scale
        var xScale    = d3.scaleLinear()
                          .domain([0, data[0].value.length])
                          .range([0, data[0].value.length * 8.42]);
                        //Creates axis
        var xAxis     = d3.axisBottom(xScale);

                        //Calls the bottom axis
                        svg.append("g")
                          .attr("class", "axis")
                          .attr("transform", "translate(0,5)")
                          .call(xAxis)
                          .select("text").remove();

                        //Resizes svg and its elements to fit to window
                        d3.select(window).on('resize', resize);

        function resize() {
                
                width = parseInt(d3.select('#area').style('width'), 10);
                        
                        svgCol.selectAll("svg")
                          .attr("width", width);
        }

        function colorize() {
                        row.selectAll("p")
                          .filter(function(d, i) { return i === 1;})
                          .selectAll("text")
                          .data(function(d) { return d.value; } )
                          .attr("class", function(d) {
                            if( d == "A")
                              return "adenine";
                            if( d == "C")
                              return "cytosine";
                            if( d == "G")
                              return "guanine";
                            if( d == "T")
                              return "thymine";
                          });
        };

        function defaultize() {
                        row.selectAll("p")
                          .filter(function(d, i) { return i === 1;})
                          .selectAll("text")
                          .attr("class", "sequence");
        };
    </script>
  </body>
</html>
